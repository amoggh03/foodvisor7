<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Track Your Calories - FoodVisor</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
            transition: background 0.3s ease, color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
        }

        body {
            --primary-color: #8B5CF6;
            --hover-color: #A78BFA;
            --text-color: #E0E0E0;
            --bg-blur: rgba(0, 0, 0, 0.7);
            --border-color: rgba(255, 255, 255, 0.3);
            background: #0B0B0B;
            color: var(--text-color);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
        }

        body.light-mode {
            --text-color: #1A1A1A;
            --bg-blur: rgba(255, 255, 255, 0.9);
            --border-color: rgba(0, 0, 0, 0.2);
            background: #FFFFFF;
        }

        .floating-icons {
            position: fixed;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            z-index: 5;
            pointer-events: none;
        }

        .floating-icon {
            position: absolute;
            font-size: 30px;
            color: #666;
            filter: grayscale(100%) opacity(0.7);
            animation: float 15s infinite linear;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            pointer-events: auto;
            z-index: 6;
        }

        .floating-icon:hover {
            filter: grayscale(0%) opacity(1);
            color: var(--hover-color);
        }

        .floating-icon.apple { animation-duration: 20s; }
        .floating-icon.apple:hover { color: #FF5555; }
        .floating-icon.broccoli { animation-duration: 18s; animation-delay: -5s; }
        .floating-icon.broccoli:hover { color: #FFAA00; }
        .floating-icon.lemon { animation-duration: 17s; animation-delay: -2s; }
        .floating-icon.lemon:hover { color: #FFFF00; }
        .floating-icon.utensils { animation-duration: 23s; animation-delay: -8s; }
        .floating-icon.utensils:hover { color: #FFAA00; }
        .floating-icon.shield { animation-duration: 16s; animation-delay: -4s; }
        .floating-icon.shield:hover { color: #3B82F6; }

        @keyframes float {
            0% { transform: translate(0, 0); }
            20% { transform: translate(50px, 100px); }
            40% { transform: translate(-30px, 200px); }
            60% { transform: translate(70px, 300px); }
            80% { transform: translate(-50px, 100px); }
            100% { transform: translate(0, 0); }
        }

        .navbar {
            position: fixed;
            top: 0;
            width: 100%;
            padding: 10px 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            background: var(--bg-blur);
            backdrop-filter: blur(15px);
            border-bottom: 1px solid var(--border-color);
            z-index: 10;
        }

        .nav-links {
            list-style: none;
            display: flex;
            gap: 20px;
            margin: 0;
            padding: 0;
            align-items: center;
        }

        .nav-links li a {
            color: var(--text-color);
            text-decoration: none;
            font-size: 1em;
            font-weight: 500;
            padding: 8px 15px;
            border-radius: 20px;
        }

        .nav-links li a:hover {
            color: var(--hover-color);
            background: rgba(139, 92, 246, 0.1);
        }

        .theme-toggle {
            cursor: pointer;
        }

        .theme-toggle i {
            font-size: 20px;
            color: var(--primary-color);
            animation: bounce 2s infinite;
        }

        .light-mode .theme-toggle i {
            color: var(--text-color);
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .hamburger {
            display: none;
            flex-direction: column;
            gap: 5px;
            cursor: pointer;
            position: absolute;
            right: 20px;
        }

        .hamburger span {
            width: 25px;
            height: 3px;
            background: var(--primary-color);
        }

        .light-mode .hamburger span {
            background: var(--text-color);
        }

        @media (max-width: 768px) {
            .nav-links {
                display: none;
                flex-direction: column;
                position: absolute;
                top: 60px;
                left: 0;
                width: 100%;
                background: var(--bg-blur);
                padding: 10px 0;
                backdrop-filter: blur(15px);
                border-bottom: 1px solid var(--border-color);
            }

            .nav-links.show {
                display: flex;
            }

            .nav-links li {
                text-align: center;
                padding: 10px 0;
            }

            .hamburger {
                display: flex;
            }

            .theme-toggle {
                margin-right: 60px;
            }
        }

        .main-container {
            display: grid;
            grid-template-columns: 250px minmax(0, 450px) 300px;
            gap: 15px;
            padding: 80px 0;
            min-height: 100vh;
            max-width: 1400px;
            margin: 0 auto;
            justify-content: space-between;
            position: relative;
            z-index: 1;
        }

        .ring-chart-container {
            grid-column: 1;
            justify-self: start;
        }

        .content-area {
            grid-column: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .sidebar {
            grid-column: 3;
            background: var(--bg-blur);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(20px);
            box-shadow: 0 0 20px rgba(139, 92, 246, 0.2);
            height: fit-content;
            max-height: calc(100vh - 100px);
            overflow-y: auto;
            justify-self: end;
        }

        .light-mode .sidebar {
            box-shadow: 0 0 10px rgba(139, 92, 246, 0.5);
        }

        @media (max-width: 1024px) {
            .main-container {
                grid-template-columns: 1fr;
                justify-items: center;
                padding: 80px 20px;
            }

            .ring-chart-container, .content-area, .sidebar {
                grid-column: 1;
                width: 100%;
                max-width: 400px;
                justify-self: center;
            }

            .sidebar {
                margin-top: 20px;
            }
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2em;
            color: var(--primary-color);
            text-shadow: 0 0 10px var(--primary-color);
            animation: glow 2s infinite alternate;
        }

        .light-mode .header h1 {
            text-shadow: none;
            animation: none;
        }

        @keyframes glow {
            0% { text-shadow: 0 0 10px var(--primary-color), 0 0 20px var(--primary-color); }
            100% { text-shadow: 0 0 15px var(--primary-color), 0 0 30px var(--primary-color); }
        }

        .search-box {
            display: flex;
            align-items: center;
            width: 100%;
            max-width: 400px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 5px 10px;
            backdrop-filter: blur(10px);
            margin: 0 auto 20px;
        }

        .light-mode .search-box {
            box-shadow: 0 0 10px rgba(139, 92, 246, 0.5);
        }

        #food-search {
            flex: 1;
            padding: 8px;
            border: none;
            background: transparent;
            color: var(--text-color);
            font-size: 1em;
            outline: none;
        }

        #food-search::placeholder {
            color: #E0E0E0;
            opacity: 0.7;
        }

        .light-mode #food-search::placeholder {
            color: #1A1A1A;
        }

        #search-button {
            padding: 8px 15px;
            background: var(--primary-color);
            border: none;
            border-radius: 8px;
            color: #FFFFFF;
            font-weight: 600;
            cursor: pointer;
        }

        #search-button:hover {
            background: var(--hover-color);
            box-shadow: 0 0 10px var(--primary-color);
        }

        .results {
            max-height: 300px;
            overflow-y: auto;
            background: var(--bg-blur);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 15px;
            margin: 0 auto 20px;
            width: 100%;
            max-width: 400px;
            backdrop-filter: blur(10px);
        }

        .light-mode .results {
            box-shadow: 0 0 10px rgba(139, 92, 246, 0.5);
        }

        .food-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid var(--primary-color);
        }

        .food-item h3 {
            margin: 0;
            font-size: 1.2em;
            color: var(--primary-color);
        }

        .food-item p {
            margin: 5px 0;
            font-size: 0.9em;
        }

        .log-form {
            display: flex;
            align-items: center;
            margin-top: 10px;
        }

        .serving-size {
            padding: 8px;
            border-radius: 5px;
            border: 1px solid var(--border-color);
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-color);
            margin-right: 10px;
            width: 100px;
        }

        .serving-size::placeholder {
            color: #E0E0E0;
            opacity: 0.7;
        }

        .light-mode .serving-size::placeholder {
            color: #1A1A1A;
        }

        .log-button {
            padding: 8px 15px;
            background: var(--primary-color);
            border: none;
            border-radius: 5px;
            color: #FFFFFF;
            font-weight: 600;
            cursor: pointer;
        }

        .log-button:hover {
            background: var(--hover-color);
        }

        .logs {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .logs h2 {
            font-size: 1.2em;
            color: var(--primary-color);
            text-shadow: 0 0 5px var(--primary-color);
            margin-bottom: 10px;
        }

        .light-mode .logs h2 {
            text-shadow: none;
        }

        .log-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 10px;
            border-radius: 10px;
            border-left: 4px solid var(--primary-color);
        }

        .light-mode .log-item {
            box-shadow: 0 0 10px rgba(139, 92, 246, 0.5);
        }

        .log-item h3 {
            font-size: 1em;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .log-item p {
            font-size: 0.9em;
            margin: 3px 0;
        }

        .log-item .meal-type {
            color: var(--hover-color);
            font-weight: 500;
        }

        .ring-chart-container {
            position: relative;
            width: 250px;
            height: 250px;
            margin: 20px 0;
        }

        canvas#macro-rings {
            display: block;
            margin: 0 auto;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 10px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            font-size: 0.9em;
            color: var(--text-color);
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 5px;
        }

        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.8);
            color: var(--text-color);
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.8em;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1000;
        }

        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px auto;
        }

        .pagination button {
            padding: 8px 15px;
            background: var(--primary-color);
            border: none;
            border-radius: 5px;
            color: #FFFFFF;
            font-weight: 600;
            cursor: pointer;
        }

        .pagination button:disabled {
            background: #666;
            cursor: not-allowed;
        }

        .pagination span {
            font-size: 0.9em;
            color: var(--text-color);
            align-self: center;
        }
    </style>
</head>
<body>
    <div class="floating-icons">
        <i class="fas fa-apple-alt floating-icon apple" style="top: 10%; left: 15%;"></i>
        <i class="fas fa-carrot floating-icon broccoli" style="top: 20%; left: 80%;"></i>
        <i class="fas fa-lemon floating-icon lemon" style="top: 15%; left: 50%;"></i>
        <i class="fas fa-utensils floating-icon utensils" style="top: 65%; left: 20%;"></i>
        <i class="fas fa-shield-alt floating-icon shield" style="top: 25%; left: 70%;"></i>
        <i class="fas fa-apple-alt floating-icon apple" style="top: 80%; left: 70%;"></i>
        <i class="fas fa-carrot floating-icon broccoli" style="top: 40%; left: 10%;"></i>
        <i class="fas fa-lemon floating-icon lemon" style="top: 75%; left: 40%;"></i>
    </div>

    <nav class="navbar">
        <ul class="nav-links">
            <li><a href="/">Home</a></li>
            <li><a href="/static/tellusaboutyou.html">Personalise</a></li>
            <li><a href="/static/askme.html">Chat</a></li>
            <li><a href="/static/calorietracker.html">Track Your Calories</a></li>
            <li><a href="/static/foodsafety.html">Food Safety</a></li>
            <li class="theme-toggle" onclick="toggleTheme()">
                <i class="fas fa-moon"></i>
            </li>
        </ul>
        <div class="hamburger" onclick="toggleMenu()">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </nav>

    <div class="main-container">
        <div class="ring-chart-container">
            <canvas id="macro-rings" width="250" height="250"></canvas>
            <div class="legend">
                <div class="legend-item">
                    <span class="legend-color" style="background: #8B5CF6;"></span> Carbs
                </div>
                <div class="legend-item">
                    <span class="legend-color" style="background: #D946EF;"></span> Protein
                </div>
                <div class="legend-item">
                    <span class="legend-color" style="background: #3B82F6;"></span> Fats
                </div>
            </div>
            <div class="tooltip" id="ring-tooltip"></div>
        </div>
        <div class="content-area">
            <div class="header">
                <h1>Track Your Calories</h1>
            </div>
            <div class="search-box">
                <input type="text" id="food-search" placeholder="Search food (e.g., Chole Bhature)">
                <button id="search-button" onclick="searchFood()">Search</button>
            </div>
            <div class="results" id="results"></div>
            <div class="pagination" id="pagination"></div>
        </div>
        <div class="sidebar">
            <div class="logs" id="logs">
                <h2>Logged Foods</h2>
            </div>
        </div>
    </div>

    <script>
        let currentPage = 1;
        let totalPages = 1;
        let maxCalories = 0;
        let maxProtein = 0;
        let maxFats = 0;
        let maxCarbs = 0;
        let totalCarbs = 0;
        let totalProtein = 0;
        let totalFats = 0;

        async function fetchUserDetails() {
            const response = await fetch('/user/details');
            const data = await response.json();
            if (data.success && data.personal_details) {
                const details = data.personal_details;
                maxCalories = data.maintenance_calories || 0;
                const weightMatch = details.match(/Weight: (\d+\.?\d*)/);
                const weight = weightMatch ? parseFloat(weightMatch[1]) : 70;
                maxProtein = weight * 2;
                maxFats = maxCalories ? Math.round((maxCalories * 0.25) / 9) : 0;
                maxCarbs = maxCalories ? Math.round((maxCalories * 0.5) / 4) : 0;
            }
        }

        function drawStackedRingChart(carbs, maxCarbs, protein, maxProtein, fats, maxFats) {
            const canvas = document.getElementById('macro-rings');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const startAngle = -Math.PI / 2;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const rings = [
                { value: carbs, max: maxCarbs, color: '#8B5CF6', radius: 100, width: 20, name: 'Carbs' },
                { value: protein, max: maxProtein, color: '#D946EF', radius: 75, width: 20, name: 'Protein' },
                { value: fats, max: maxFats, color: '#3B82F6', radius: 50, width: 20, name: 'Fats' }
            ];

            rings.forEach(ring => {
                ctx.beginPath();
                ctx.arc(centerX, centerY, ring.radius, 0, Math.PI * 2);
                ctx.lineWidth = ring.width;
                ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
                ctx.stroke();

                const endAngle = startAngle + (Math.PI * 2) * (Math.min(ring.value, ring.max || ring.value) / (ring.max || ring.value));
                ctx.beginPath();
                ctx.arc(centerX, centerY, ring.radius, startAngle, endAngle);
                ctx.lineWidth = ring.width;
                ctx.strokeStyle = ring.color;
                ctx.stroke();
            });

            const totalConsumed = Math.round(carbs) + Math.round(protein) + Math.round(fats);
            ctx.font = 'bold 18px Inter';
            ctx.fillStyle = 'var(--text-color)';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText(`${totalConsumed}g`, centerX, centerY);
        }

        function addRingHover() {
            const canvas = document.getElementById('macro-rings');
            const tooltip = document.getElementById('ring-tooltip');
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;

            const rings = [
                { value: totalCarbs, max: maxCarbs, radius: 100, width: 20, name: 'Carbs' },
                { value: totalProtein, max: maxProtein, radius: 75, width: 20, name: 'Protein' },
                { value: totalFats, max: maxFats, radius: 50, width: 20, name: 'Fats' }
            ];

            canvas.addEventListener('mousemove', (e) => {
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                const dx = x - centerX;
                const dy = y - centerY;
                const distance = Math.sqrt(dx * dx + dy * dy);

                let hovered = null;
                rings.forEach(ring => {
                    if (distance >= ring.radius - ring.width / 2 && distance <= ring.radius + ring.width / 2) {
                        hovered = ring;
                    }
                });

                if (hovered) {
                    tooltip.style.opacity = '1';
                    tooltip.style.position = 'fixed';
                    tooltip.style.left = `${e.clientX + 10}px`;
                    tooltip.style.top = `${e.clientY + 10}px`;
                    tooltip.innerText = `${hovered.name}: Consumed ${Math.round(hovered.value)}g / Remaining ${Math.round(hovered.max - hovered.value)}g`;
                } else {
                    tooltip.style.opacity = '0';
                }
            });

            canvas.addEventListener('mouseout', () => {
                tooltip.style.opacity = '0';
            });
        }

        async function updateGauges() {
            const response = await fetch('/food/logs');
            const data = await response.json();
            if (!data.success) return;

            totalCarbs = 0;
            totalProtein = 0;
            totalFats = 0;

            data.logs.forEach(log => {
                const nutrients = log.nutrients;
                totalCarbs += nutrients.carbs;
                totalProtein += nutrients.protein;
                totalFats += nutrients.fats;
            });

            drawStackedRingChart(totalCarbs, maxCarbs, totalProtein, maxProtein, totalFats, maxFats);
            addRingHover();
        }

        async function clearFoodLogs() {
            try {
                const response = await fetch('/food/clear', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({})
                });
                const data = await response.json();
                if (data.success) {
                    loadFoodLogs();
                    updateGauges();
                } else {
                    alert('Error clearing logs: ' + (data.error || 'Unknown error'));
                }
            } catch (error) {
                alert('Error clearing logs: ' + error.message);
            }
        }

        async function searchFood() {
            const query = document.getElementById('food-search').value.trim();
            if (!query) {
                alert('Please enter a food name');
                return;
            }

            const response = await fetch(`/food/search?query=${encodeURIComponent(query)}&page=${currentPage}`);
            const data = await response.json();

            if (!data.success) {
                alert(data.error);
                return;
            }

            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '';

            data.data.results.forEach(food => {
                const foodDiv = document.createElement('div');
                foodDiv.className = 'food-item';
                foodDiv.innerHTML = `
                    <h3>${food.food_name}</h3>
                    <p>Serving Size: ${food.serving_size}g (${food.serving_type})</p>
                    <p>Calories: ${food.nutrients.calories} kcal</p>
                    <p>Fats: ${food.nutrients.fats}g | Carbs: ${food.nutrients.carbs}g | Protein: ${food.nutrients.protein}g</p>
                    <p>Per 100g: ${food.normalized_per_100g.calories} kcal, ${food.normalized_per_100g.fats}g fats, ${food.normalized_per_100g.carbs}g carbs, ${food.normalized_per_100g.protein}g protein</p>
                    <div class="log-form">
                        <input type="number" class="serving-size" placeholder="Serving size (g)" min="1" step="any">
                        <button class="log-button" onclick='logFood(${JSON.stringify(food)})'>Log</button>
                    </div>
                `;
                resultsDiv.appendChild(foodDiv);
            });

            totalPages = data.data.total_pages;
            updatePagination();
            updateGauges();
        }

        async function logFood(food) {
            const servingSizeInput = event.target.previousElementSibling;
            const servingSize = parseFloat(servingSizeInput.value);
            if (!servingSize || servingSize <= 0) {
                alert('Please enter a valid serving size');
                return;
            }

            const response = await fetch('/food/track', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    food_id: food.food_id,
                    food_name: food.food_name,
                    serving_size: servingSize,
                    nutrients: food.nutrients,
                    food_serving_size: food.serving_size,
                    timestamp: new Date().toISOString()
                })
            });
            const data = await response.json();

            if (data.success) {
                alert('Food logged successfully!');
                servingSizeInput.value = '';
                loadFoodLogs();
                updateGauges();
            } else {
                alert(data.error);
            }
        }

        function getMealType(timestamp) {
            const date = new Date(timestamp);
            const hours = date.getHours();
            if (hours >= 6 && hours < 12) return 'Breakfast';
            if (hours >= 12 && hours < 16) return 'Lunch';
            if (hours >= 16 && hours < 22) return 'Dinner';
            return 'Snack';
        }

        async function loadFoodLogs() {
            const response = await fetch('/food/logs');
            const data = await response.json();

            if (!data.success) {
                console.error(data.error);
                return;
            }

            const logsDiv = document.getElementById('logs');
            logsDiv.innerHTML = '<h2>Logged Foods</h2>';

            if (data.logs.length === 0) {
                logsDiv.innerHTML += '<p>No foods logged yet.</p>';
                return;
            }

            const mealOrder = { 'Breakfast': 1, 'Lunch': 2, 'Dinner': 3, 'Snack': 4 };
            const sortedLogs = data.logs.sort((a, b) => {
                const mealA = getMealType(a.timestamp);
                const mealB = getMealType(b.timestamp);
                return mealOrder[mealA] - mealOrder[mealB];
            });

            sortedLogs.forEach(log => {
                const mealType = getMealType(log.timestamp);
                const logDiv = document.createElement('div');
                logDiv.className = 'log-item';
                logDiv.setAttribute('data-id', log.id);
                logDiv.innerHTML = `
                    <h3>${log.food_name}</h3>
                    <p class="meal-type">Meal: ${mealType}</p>
                    <p>Serving Size: ${log.serving_size}g</p>
                    <p>Calories: ${log.nutrients.calories} kcal</p>
                    <p>Fats: ${log.nutrients.fats}g | Carbs: ${log.nutrients.carbs}g | Protein: ${log.nutrients.protein}g</p>
                    <p>Logged at: ${new Date(log.timestamp).toLocaleString()}</p>
                `;
                logsDiv.appendChild(logDiv);
            });

            updateGauges();
        }

        function updatePagination() {
            const paginationDiv = document.getElementById('pagination');
            paginationDiv.innerHTML = `
                <button onclick="changePage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>Previous</button>
                <span>Page ${currentPage} of ${totalPages}</span>
                <button onclick="changePage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>Next</button>
            `;
        }

        function changePage(page) {
            if (page >= 1 && page <= totalPages) {
                currentPage = page;
                searchFood();
            }
        }

        function toggleMenu() {
            const navLinks = document.querySelector('.nav-links');
            navLinks.classList.toggle('show');
        }

        function toggleTheme() {
            document.body.classList.toggle('light-mode');
            const themeIcon = document.querySelector('.theme-toggle i');
            themeIcon.classList.toggle('fa-moon');
            themeIcon.classList.toggle('fa-sun');
        }

        window.onload = async () => {
            const saveLogs = confirm('Do you want to save the logs or the session?');
            if (!saveLogs) {
                await clearFoodLogs();
            }
            await fetchUserDetails();
            await loadFoodLogs();
        };
    </script>
</body>
</html>